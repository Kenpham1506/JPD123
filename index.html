/* index.html */
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>TTS Conversation Player</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<div class="container">
		<h1>TTS Conversation Player</h1>
		<textarea id="inputText" placeholder="Enter conversation text..."></textarea>
		<button id="generateBtn">Generate Audio</button>
		<div class="player" id="audioPlayer" style="display: none;">
			<audio id="audio" controls></audio>
		</div>
	</div>
	<script src="script.js"></script>
</body>
</html>

/* style.css */
body {
	font-family: Arial, sans-serif;
	background: #f4f4f4;
	margin: 0;
	padding: 20px;
	display: flex;
	justify-content: center;
	align-items: center;
	height: 100vh;
}

.container {
	background: white;
	padding: 20px;
	border-radius: 10px;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	width: 90%;
	max-width: 600px;
}

textarea {
	width: 100%;
	height: 200px;
	margin-bottom: 10px;
	padding: 10px;
	font-size: 16px;
	border: 1px solid #ccc;
	border-radius: 5px;
	resize: vertical;
}

button {
	padding: 10px 20px;
	background: #007bff;
	color: white;
	border: none;
	border-radius: 5px;
	cursor: pointer;
}

button:hover {
	background: #0056b3;
}

.player {
	margin-top: 20px;
}

/* script.js */
document.getElementById('generateBtn').addEventListener('click', async () => {
	const inputText = document.getElementById('inputText').value;
	const modifiedText = inputText.replace(/\[speaker:Takumi\]/g, '[speaker:Takumi]')
		.replace(/\[speaker:Mizuki\]/g, '[speaker:Mizuki]')
		.replace(/\[speaker:Takumi\][\s\S]*?(?=\[speaker:Mizuki\]|$)/g, match => match.trim() + '  <break time="10s"/>')
		.replace(/\[speaker:Mizuki\][\s\S]*?(?=\[speaker:Takumi\]|$)/g, match => match.trim());

	const payload = new URLSearchParams();
	payload.append('msg', modifiedText);
	payload.append('lang', 'Takumi');
	payload.append('source', 'ttsmp3');

	try {
		const response = await fetch('https://ttsmp3.com/makemp3_new.php', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
			},
			body: payload
		});

		const result = await response.json();
		if (result.success && result.URL) {
			document.getElementById('audio').src = result.URL;
			document.getElementById('audioPlayer').style.display = 'block';
		} else {
			alert('Failed to generate audio. Please try again.');
		}
	} catch (error) {
		console.error(error);
		alert('An error occurred while generating the audio.');
	}
});
